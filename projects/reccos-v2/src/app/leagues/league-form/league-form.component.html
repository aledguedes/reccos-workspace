<div class="p-6">
  <div class="mb-6">
    <h1 class="text-2xl font-bold text-base-content">Nova Liga</h1>
    <p class="text-sm text-base-content/70">
      Preencha os dados para criar uma nova liga
    </p>
  </div>

  <div class="card bg-base-100 shadow-md">
    <div class="card-body">
      <!-- Stepper de navegação -->
      <ul class="steps steps-horizontal w-full mb-8">
        <li
          class="step"
          [ngClass]="{ 'step-primary': currentStep >= 1 }"
          (click)="goToStep(1)"
        >
          Informações Básicas
        </li>
        <li
          class="step"
          [ngClass]="{ 'step-primary': currentStep >= 2 }"
          (click)="goToStep(2)"
        >
          Formato do Torneio
        </li>
        <li
          class="step"
          [ngClass]="{ 'step-primary': currentStep >= 3 }"
          (click)="goToStep(3)"
        >
          Revisão
        </li>
      </ul>

      <form [formGroup]="leagueForm" (ngSubmit)="onSubmit()">
        <!-- Passo 1: Informações Básicas -->
        @if (currentStep === 1) {
          <div class="space-y-4">
            <app-basic-info [parentForm]="leagueForm" (proceed)="nextStep()" />
          </div>
        }

        <!-- Passo 2: Formato do Torneio -->
        @if (currentStep === 2) {
          <div class="space-y-4">
            <app-tournament-format
              [parentForm]="leagueForm"
              (proceed)="nextStep()"
            />
          </div>
        }

        <!-- Passo 3: Revisão -->
        @if (currentStep === 3) {
          <div class="space-y-4">
            <h2 class="text-xl font-semibold mb-4">Revisão</h2>

            <div class="bg-base-200 p-4 rounded-lg">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <h3 class="font-medium text-base-content/70">
                    Informações Básicas
                  </h3>
                  <p>
                    <span class="font-semibold">Nome:</span>
                    {{ leagueForm.get('name')?.value }}
                  </p>
                  <p>
                    <span class="font-semibold">Temporada:</span>
                    {{ leagueForm.get('season')?.value }}
                  </p>
                </div>

                <div>
                  <h3 class="font-medium text-base-content/70">
                    Configurações de Temporada
                  </h3>
                  <p>
                    <span class="font-semibold">Data de Início:</span>
                    {{ formatDate(leagueForm.get('startDate')?.value) }}
                  </p>
                  <p>
                    <span class="font-semibold">Data de Término:</span>
                    {{ formatDate(leagueForm.get('endDate')?.value) }}
                  </p>
                  <p>
                    <span class="font-semibold">Status:</span>
                    {{ getStatusLabel(leagueForm.get('status')?.value) }}
                  </p>
                </div>
              </div>

              <div class="mt-4">
                <h3 class="font-medium text-base-content/70">
                  Formato do Torneio
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                  <div>
                    <p>
                      <span class="font-semibold">Formato:</span>
                      {{
                        leagueForm.get('format')?.value === 'league'
                          ? 'Liga (todos contra todos)'
                          : leagueForm.get('format')?.value === 'cup'
                            ? 'Copa (eliminatórias)'
                            : 'Grupos + Eliminatórias'
                      }}
                    </p>
                    <p>
                      <span class="font-semibold">Número de Equipes:</span>
                      {{ leagueForm.get('teamsCount')?.value }}
                    </p>
                    <p
                      *ngIf="
                        leagueForm.get('format')?.value === 'group_knockout'
                      "
                    >
                      <span class="font-semibold">Times por Grupo:</span>
                      {{ leagueForm.get('teamsPerGroup')?.value }}
                    </p>
                  </div>
                  <div>
                    <p>
                      <span class="font-semibold">Jogadores por Equipe:</span>
                      {{ leagueForm.get('playersPerTeam')?.value }}
                    </p>
                    <p>
                      <span class="font-semibold">Duração das Partidas:</span>
                      {{ leagueForm.get('matchDuration')?.value }} minutos
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        }

        <!-- Botões de navegação -->
        <div class="flex justify-between mt-8">
          <button
            *ngIf="currentStep > 1"
            type="button"
            class="btn btn-outline"
            (click)="previousStep()"
            [disabled]="isSubmitting"
          >
            Voltar
          </button>
          <div class="flex-grow"></div>
          <button
            *ngIf="currentStep < 3"
            type="button"
            class="btn btn-primary"
            (click)="nextStep()"
            [disabled]="!canProceed() || isSubmitting"
          >
            Próximo
          </button>
          <button
            *ngIf="currentStep === 3"
            type="submit"
            class="btn btn-primary"
            [disabled]="leagueForm.invalid || isSubmitting"
          >
            <span
              *ngIf="isSubmitting"
              class="loading loading-spinner loading-xs mr-2"
            ></span>
            Finalizar Cadastro
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
